!function(){"use strict";const e=document.querySelector(".profile__edit-button"),t=document.querySelector(".profile__add-button"),s=document.querySelector("#photos-display-modal"),r=document.querySelector(".photos__list"),i=(s.querySelector(".modal__photos-link"),s.querySelector(".modal__photos-title"),document.querySelector(".profile__avatar-btn"));class n{constructor(e,t,s,r,i){this._cardName=e.name,this._cardImage=e.link,this._cardAlt=e.name,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteCard=r,this._handleLikeCard=i,this._id=e._id,this._isLiked=e.isLiked}_getView(){this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".photos__card").cloneNode(!0),this._likeButton=this._cardElement.querySelector(".photos__like-button"),this._deleteButton=this._cardElement.querySelector(".photos__delete-button"),this._cardImageButton=this._cardElement.querySelector(".photos__image"),this._cardElementName=this._cardElement.querySelector(".photos__caption"),this._cardElementImage=this._cardElement.querySelector(".photos__image"),!0===this._isLiked&&this._likeCard()}_setCardData(){this._cardElementName.textContent=this._cardName,this._cardElementImage.src=this._cardImage,this._cardElementImage.alt=this._cardName}getCardElement(){return this._cardElement}generateCard(){return this._getView(),this._setEventListeners(),this._setCardData(),this._cardElement}getCardId(){return this._id}getCardIsLiked(){return this._isLiked}deleteCard(){this._cardElement.remove(),this._cardElement=null}_likeCard(){this._likeButton.classList.add("photos__like-button_active"),this._isLiked=!0}_dislikeCard(){this._likeButton.classList.remove("photos__like-button_active"),this._isLiked=!1}updateCardLike(){!1===this._isLiked?this._likeCard():this._dislikeCard()}_setEventListeners(){this._deleteButton.addEventListener("click",(()=>{this._handleDeleteCard(this)})),this._cardImageButton.addEventListener("click",(()=>{this._handleImageClick({name:this._cardName,link:this._cardImage})})),this._likeButton.addEventListener("click",(()=>{this._handleLikeCard(this)}))}}class o{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._fieldsetSelector=e.fieldsetSelector,this._formElement=t}_showInputError(e){const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}_setEventListeners(){this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}}class a{constructor(e){this._popupElement=document.querySelector(e),this._closeButton=this._popupElement.querySelector(".modal__close-button")}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("mousedown",this._closeOnOverlayClick),document.addEventListener("keydown",this._closeOnEscKey)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("mousedown",this._closeOnOverlayClick),document.removeEventListener("keydown",this._closeOnEscKey)}_closeOnOverlayClick=e=>{e.target.classList.contains("modal_opened")&&this.close()};_closeOnEscKey=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._closeButton.addEventListener("click",(()=>{this.close()}))}}class l extends a{constructor(e,t){super(e),this._handleFormSubmit=t,this._submitButton=this._popupElement.querySelector(".modal__submit-button"),this._popupForm=this._popupElement.querySelector(".modal__container"),this._popupArray=this._popupElement.querySelectorAll(".modal__input"),this._inputList=Array.from(this._popupArray),this._originalSubmitText=this._submitButton.textContent}_getInputValue(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}renderLoading(e){this._submitButton.textContent=e?"Saving...":this._originalSubmitText}setSubmit(e){this._handleFormSubmit=e}reset(){this._popupForm.reset()}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){this._popupForm.addEventListener("submit",(()=>{this._handleFormSubmit(this._getInputValue())})),super.setEventListeners()}}const d=new class{constructor(e){this._headers=e.headers,this._baseUrl=e.baseUrl,this._authToken=e.headers.authorization}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e,t){return fetch(e,t).then(this._checkResponse)}getInitialCards(){return this._request(`${this._baseUrl}/cards`,{headers:this._headers})}getUserInformation(){return Promise.all([this.getUser(),this.getInitialCards()])}getUser(){return this._request(`${this._baseUrl}/users/me`,{headers:this._headers})}updateUserInformation(e){return this._request(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})})}addCard(e){return this._request(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})})}deleteCard(e){return this._request(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers,message:"This post has been deleted"})}likeCard(e){return this._request(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers})}dislikeCard(e){return this._request(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers})}udpateAvatar(e){return this._request(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"b88b770f-9665-4862-bc7a-1a5aa8c4147a","Content-Type":"application/json"}}),h=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}addItem(e){this._renderer(e)}renderItems(e){e.forEach((e=>{this._renderer(e,"append")}))}}({renderer:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"prepend";const s=new n(e,"#photos-template",f,C,g,!1).generateCard();r[t](s)}},"#card-add-form");d.getInitialCards().then((e=>{h.renderItems(e),e.forEach((e=>{}))})).catch((e=>{console.error(e)}));const c=new l("#card-add-modal",(function(e){c.renderLoading(!0),d.addCard(e).then((e=>{var t;t=e,h.addItem(t),c.close(),c.reset()})).catch(console.error).finally((()=>{c.renderLoading(!1)}))}));c.setEventListeners();const _=new l("#profile-edit-modal",(function(e){_.renderLoading(!0),d.updateUserInformation(e).then((e=>{m.setUserInfo(e),_.close(),_.reset()})).catch(console.error).finally((()=>{_.renderLoading(!1)}))}));_.setEventListeners();const u=new class extends a{constructor(e){super(e),this._imageTitle=this._popupElement.querySelector(".modal__photos-title"),this._imageLink=this._popupElement.querySelector(".modal__photos-link")}open(e){let{name:t,link:s}=e;this._imageTitle.textContent=t,this._imageLink.src=s,this._imageLink.alt=t,super.open()}}("#photos-display-modal");u.setEventListeners();const m=new class{constructor(e,t,s){this._profileName=document.querySelector(e),this._profileDescription=document.querySelector(t),this._profileAvatar=document.querySelector(s)}getUserInfo(){return{name:this._profileName.textContent,about:this._profileDescription.textContent,avatar:this._profileAvatar.src}}setUserInfo(e){let{name:t,about:s,avatar:r}=e;this._profileName.textContent=t,this._profileDescription.textContent=s,this.setUserAvatar(r)}setUserAvatar(e){this._profileAvatar.src=e}}(".profile__name",".profile__description",".profile__avatar-picture"),p=new l("#delete-card-modal");p.setEventListeners();const E=new l("#avatar-update-modal",(function(e){let{name:t}=e;E.renderLoading(!0),d.udpateAvatar(t).then((()=>{m.setUserAvatar(t),E.close(),E.reset()})).catch(console.error).finally((()=>{E.renderLoading(!1)}))}));E.setEventListeners();const v={};var L;function f(e){let{name:t,link:s}=e;u.open({name:t,link:s})}function C(e){const t=e.getCardId();p.open(),p.setSubmit((()=>{p.renderLoading(!0),d.deleteCard(t).then((()=>{e.deleteCard(),p.close()})).catch(console.error).finally((()=>{p.renderLoading(!1)}))}))}function g(e){const t=e.getCardId();0==e.getCardIsLiked()?d.likeCard(t).then((()=>{e.updateCardLike()})).catch(console.error):d.dislikeCard(t).then((()=>{e.updateCardLike()})).catch(console.error)}L={formSelector:".modal__container",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_inactive",inputErrorClass:"modal__input_type_error",errorClass:"modal__input-error_active",fieldsetSelector:".modal__fieldset"},Array.from(document.querySelectorAll(L.formSelector)).forEach((e=>{const t=new o(L,e),s=e.getAttribute("id");v[s]=t,t.enableValidation()})),e.addEventListener("click",(()=>{_.setInputValues(m.getUserInfo()),_.open(),v["profile-form"].resetValidation()})),t.addEventListener("click",(()=>{c.open(),v["card-add-form"].resetValidation()})),i.addEventListener("click",(()=>{E.open(),v["avatar-update-form"].resetValidation()})),d.getUser().then((e=>{m.setUserInfo(e)})).catch(console.error)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQUEsTUEyQk1BLEVBQW9CQyxTQUFTQyxjQUFjLHlCQUszQ0MsRUFBZ0JGLFNBQVNDLGNBQWMsd0JBRXZDRSxFQUFtQkgsU0FBU0MsY0FBYyx5QkFHMUNHLEVBQWdCSixTQUFTQyxjQUFjLGlCQVd2Q0ksR0FSdUJGLEVBQWlCRixjQUM1Qyx1QkFHMkJFLEVBQWlCRixjQUM1Qyx3QkFHbUJELFNBQVNDLGNBQWMseUJDaEQ1QyxNQUFNSyxFQUNKQyxXQUFBQSxDQUNFQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxHQUVBQyxLQUFLQyxVQUFZTixFQUFLTyxLQUN0QkYsS0FBS0csV0FBYVIsRUFBS1MsS0FDdkJKLEtBQUtLLFNBQVdWLEVBQUtPLEtBQ3JCRixLQUFLTSxjQUFnQlYsRUFDckJJLEtBQUtPLGtCQUFvQlYsRUFDekJHLEtBQUtRLGtCQUFvQlYsRUFDekJFLEtBQUtTLGdCQUFrQlYsRUFDdkJDLEtBQUtVLElBQU1mLEVBQUtlLElBQ2hCVixLQUFLVyxTQUFXaEIsRUFBS2lCLE9BQ3ZCLENBRUFDLFFBQUFBLEdBQ0ViLEtBQUtjLGFBQWUzQixTQUNqQkMsY0FBY1ksS0FBS00sZUFDbkJTLFFBQVEzQixjQUFjLGlCQUN0QjRCLFdBQVUsR0FDYmhCLEtBQUtpQixZQUFjakIsS0FBS2MsYUFBYTFCLGNBQWMsd0JBQ25EWSxLQUFLa0IsY0FBZ0JsQixLQUFLYyxhQUFhMUIsY0FDckMsMEJBRUZZLEtBQUttQixpQkFBbUJuQixLQUFLYyxhQUFhMUIsY0FBYyxrQkFDeERZLEtBQUtvQixpQkFBbUJwQixLQUFLYyxhQUFhMUIsY0FBYyxvQkFDeERZLEtBQUtxQixrQkFBb0JyQixLQUFLYyxhQUFhMUIsY0FBYyxtQkFFbkMsSUFBbEJZLEtBQUtXLFVBQ1BYLEtBQUtzQixXQUVULENBRUFDLFlBQUFBLEdBQ0V2QixLQUFLb0IsaUJBQWlCSSxZQUFjeEIsS0FBS0MsVUFDekNELEtBQUtxQixrQkFBa0JJLElBQU16QixLQUFLRyxXQUNsQ0gsS0FBS3FCLGtCQUFrQkssSUFBTTFCLEtBQUtDLFNBQ3BDLENBRUEwQixjQUFBQSxHQUNFLE9BQU8zQixLQUFLYyxZQUNkLENBRUFjLFlBQUFBLEdBS0UsT0FKQTVCLEtBQUthLFdBQ0xiLEtBQUs2QixxQkFDTDdCLEtBQUt1QixlQUVFdkIsS0FBS2MsWUFDZCxDQUVBZ0IsU0FBQUEsR0FDRSxPQUFPOUIsS0FBS1UsR0FDZCxDQUVBcUIsY0FBQUEsR0FDRSxPQUFPL0IsS0FBS1csUUFDZCxDQUVBcUIsVUFBQUEsR0FDRWhDLEtBQUtjLGFBQWFtQixTQUNsQmpDLEtBQUtjLGFBQWUsSUFDdEIsQ0FFQVEsU0FBQUEsR0FDRXRCLEtBQUtpQixZQUFZaUIsVUFBVUMsSUFBSSw4QkFDL0JuQyxLQUFLVyxVQUFXLENBQ2xCLENBRUF5QixZQUFBQSxHQUNFcEMsS0FBS2lCLFlBQVlpQixVQUFVRCxPQUFPLDhCQUNsQ2pDLEtBQUtXLFVBQVcsQ0FDbEIsQ0FFQTBCLGNBQUFBLElBQ3dCLElBQWxCckMsS0FBS1csU0FDUFgsS0FBS3NCLFlBRUx0QixLQUFLb0MsY0FFVCxDQUVBUCxrQkFBQUEsR0FDRTdCLEtBQUtrQixjQUFjb0IsaUJBQWlCLFNBQVMsS0FDM0N0QyxLQUFLUSxrQkFBa0JSLEtBQUssSUFHOUJBLEtBQUttQixpQkFBaUJtQixpQkFBaUIsU0FBUyxLQUM5Q3RDLEtBQUtPLGtCQUFrQixDQUFFTCxLQUFNRixLQUFLQyxVQUFXRyxLQUFNSixLQUFLRyxZQUFhLElBR3pFSCxLQUFLaUIsWUFBWXFCLGlCQUFpQixTQUFTLEtBQ3pDdEMsS0FBS1MsZ0JBQWdCVCxLQUFLLEdBRTlCLEVDbEdLLE1BQU11QyxFQUNYN0MsV0FBQUEsQ0FBWThDLEVBQWtCQyxHQUM1QnpDLEtBQUswQyxlQUFpQkYsRUFBaUJHLGNBQ3ZDM0MsS0FBSzRDLHNCQUF3QkosRUFBaUJLLHFCQUM5QzdDLEtBQUs4QyxxQkFBdUJOLEVBQWlCTyxvQkFDN0MvQyxLQUFLZ0QsaUJBQW1CUixFQUFpQlMsZ0JBQ3pDakQsS0FBS2tELFlBQWNWLEVBQWlCVyxXQUNwQ25ELEtBQUtvRCxrQkFBb0JaLEVBQWlCYSxpQkFDMUNyRCxLQUFLc0QsYUFBZWIsQ0FDdEIsQ0FFQWMsZUFBQUEsQ0FBZ0JDLEdBQ2QsTUFBTUMsRUFBZXpELEtBQUtzRCxhQUFhbEUsY0FDcEMsSUFBR29FLEVBQWFFLFlBRW5CRixFQUFhdEIsVUFBVUMsSUFBSW5DLEtBQUtnRCxrQkFDaENTLEVBQWFqQyxZQUFjZ0MsRUFBYUcsa0JBQ3hDRixFQUFhdkIsVUFBVUMsSUFBSW5DLEtBQUtrRCxZQUNsQyxDQUVBVSxlQUFBQSxDQUFnQkosR0FDZCxNQUFNQyxFQUFlekQsS0FBS3NELGFBQWFsRSxjQUNwQyxJQUFHb0UsRUFBYUUsWUFFbkJGLEVBQWF0QixVQUFVRCxPQUFPakMsS0FBS2dELGtCQUNuQ1MsRUFBYXZCLFVBQVVELE9BQU9qQyxLQUFLa0QsYUFDbkNPLEVBQWFqQyxZQUFjLEVBQzdCLENBRUFxQyxrQkFBQUEsR0FDTTdELEtBQUs4RCxvQkFDUDlELEtBQUsrRCxlQUFlN0IsVUFBVUMsSUFBSW5DLEtBQUs4QyxzQkFDdkM5QyxLQUFLK0QsZUFBZUMsVUFBVyxJQUUvQmhFLEtBQUsrRCxlQUFlN0IsVUFBVUQsT0FBT2pDLEtBQUs4QyxzQkFDMUM5QyxLQUFLK0QsZUFBZUMsVUFBVyxFQUVuQyxDQUVBRixnQkFBQUEsR0FDRSxPQUFPOUQsS0FBS2lFLFdBQVdDLE1BQU1WLElBQ25CQSxFQUFhVyxTQUFTQyxPQUVsQyxDQUVBQyxtQkFBQUEsQ0FBb0JiLEdBQ2JBLEVBQWFXLFNBQVNDLE1BR3pCcEUsS0FBSzRELGdCQUFnQkosR0FGckJ4RCxLQUFLdUQsZ0JBQWdCQyxFQUl6QixDQUVBYyxlQUFBQSxHQUNFdEUsS0FBSzZELHFCQUVMN0QsS0FBS2lFLFdBQVdNLFNBQVNmLElBQ3ZCeEQsS0FBSzRELGdCQUFnQkosRUFBYSxHQUV0QyxDQUVBM0Isa0JBQUFBLEdBQ0U3QixLQUFLaUUsV0FBYU8sTUFBTUMsS0FDdEJ6RSxLQUFLc0QsYUFBYW9CLGlCQUFpQjFFLEtBQUswQyxpQkFFMUMxQyxLQUFLK0QsZUFBaUIvRCxLQUFLc0QsYUFBYWxFLGNBQ3RDWSxLQUFLNEMsdUJBRVA1QyxLQUFLNkQscUJBRUw3RCxLQUFLaUUsV0FBV00sU0FBU2YsSUFDdkJBLEVBQWFsQixpQkFBaUIsU0FBUyxLQUNyQ3RDLEtBQUtxRSxvQkFBb0JiLEdBQ3pCeEQsS0FBSzZELG9CQUFvQixHQUN6QixHQUVOLENBRUFjLGdCQUFBQSxHQUNFM0UsS0FBS3NELGFBQWFoQixpQkFBaUIsVUFBVSxTQUFVc0MsR0FDckRBLEVBQUlDLGdCQUNOLElBQ0E3RSxLQUFLNkIsb0JBQ1AsRUNuRkssTUFBTWlELEVBQ1hwRixXQUFBQSxDQUFZcUYsR0FDVi9FLEtBQUtnRixjQUFnQjdGLFNBQVNDLGNBQWMyRixHQUM1Qy9FLEtBQUtpRixhQUFlakYsS0FBS2dGLGNBQWM1RixjQUNyQyx1QkFFSixDQUVBOEYsSUFBQUEsR0FDRWxGLEtBQUtnRixjQUFjOUMsVUFBVUMsSUFBSSxnQkFDakNoRCxTQUFTbUQsaUJBQWlCLFlBQWF0QyxLQUFLbUYsc0JBQzVDaEcsU0FBU21ELGlCQUFpQixVQUFXdEMsS0FBS29GLGVBQzVDLENBRUFDLEtBQUFBLEdBQ0VyRixLQUFLZ0YsY0FBYzlDLFVBQVVELE9BQU8sZ0JBQ3BDOUMsU0FBU21HLG9CQUFvQixZQUFhdEYsS0FBS21GLHNCQUMvQ2hHLFNBQVNtRyxvQkFBb0IsVUFBV3RGLEtBQUtvRixlQUMvQyxDQUVBRCxxQkFBd0JQLElBQ2xCQSxFQUFJVyxPQUFPckQsVUFBVXNELFNBQVMsaUJBQ2hDeEYsS0FBS3FGLE9BQ1AsRUFHRkQsZUFBa0JSLElBQ0EsV0FBWkEsRUFBSWEsS0FDTnpGLEtBQUtxRixPQUNQLEVBR0ZLLGlCQUFBQSxHQUNFMUYsS0FBS2lGLGFBQWEzQyxpQkFBaUIsU0FBUyxLQUMxQ3RDLEtBQUtxRixPQUFPLEdBRWhCLEVDbENLLE1BQU1NLFVBQXNCYixFQUNqQ3BGLFdBQUFBLENBQVlxRixFQUFlYSxHQUN6QkMsTUFBTWQsR0FDTi9FLEtBQUs4RixrQkFBb0JGLEVBRXpCNUYsS0FBSytGLGNBQWdCL0YsS0FBS2dGLGNBQWM1RixjQUN0Qyx5QkFFRlksS0FBS2dHLFdBQWFoRyxLQUFLZ0YsY0FBYzVGLGNBQWMscUJBQ25EWSxLQUFLaUcsWUFBY2pHLEtBQUtnRixjQUFjTixpQkFBaUIsaUJBQ3ZEMUUsS0FBS2lFLFdBQWFPLE1BQU1DLEtBQUt6RSxLQUFLaUcsYUFDbENqRyxLQUFLa0csb0JBQXNCbEcsS0FBSytGLGNBQWN2RSxXQUNoRCxDQUVBMkUsY0FBQUEsR0FDRSxNQUFNQyxFQUFjLENBQUMsRUFJckIsT0FIQXBHLEtBQUtpRSxXQUFXTSxTQUFTOEIsSUFDdkJELEVBQVlDLEVBQU1uRyxNQUFRbUcsRUFBTUMsS0FBSyxJQUVoQ0YsQ0FDVCxDQUVBRyxhQUFBQSxDQUFjQyxHQUVWeEcsS0FBSytGLGNBQWN2RSxZQURqQmdGLEVBQytCLFlBRUF4RyxLQUFLa0csbUJBRTFDLENBRUFPLFNBQUFBLENBQVVDLEdBQ1IxRyxLQUFLOEYsa0JBQW9CWSxDQUMzQixDQUVBQyxLQUFBQSxHQUNFM0csS0FBS2dHLFdBQVdXLE9BQ2xCLENBRUFDLGNBQUFBLENBQWVqSCxHQUNiSyxLQUFLaUUsV0FBV00sU0FBUzhCLElBQ3ZCQSxFQUFNQyxNQUFRM0csRUFBSzBHLEVBQU1uRyxLQUFLLEdBRWxDLENBRUF3RixpQkFBQUEsR0FDRTFGLEtBQUtnRyxXQUFXMUQsaUJBQWlCLFVBQVUsS0FDekN0QyxLQUFLOEYsa0JBQWtCOUYsS0FBS21HLGlCQUFpQixJQUcvQ04sTUFBTUgsbUJBQ1IsRUNsQ0YsTUFBTW1CLEVBQU0sSUNsQlosTUFDRW5ILFdBQUFBLENBQVlvSCxHQUNWOUcsS0FBSytHLFNBQVdELEVBQVFFLFFBQ3hCaEgsS0FBS2lILFNBQVdILEVBQVFJLFFBQ3hCbEgsS0FBS21ILFdBQWFMLEVBQVFFLFFBQVFJLGFBQ3BDLENBRUFDLGNBQUFBLENBQWVDLEdBQ2IsT0FBSUEsRUFBSUMsR0FDQ0QsRUFBSUUsT0FFTkMsUUFBUUMsT0FBUSxVQUFTSixFQUFJSyxTQUN0QyxDQUVBQyxRQUFBQSxDQUFTQyxFQUFLZixHQUNaLE9BQU9nQixNQUFNRCxFQUFLZixHQUFTaUIsS0FBSy9ILEtBQUtxSCxlQUN2QyxDQUVBVyxlQUFBQSxHQUNFLE9BQU9oSSxLQUFLNEgsU0FBVSxHQUFFNUgsS0FBS2lILGlCQUFrQixDQUFFRCxRQUFTaEgsS0FBSytHLFVBQ2pFLENBRUFrQixrQkFBQUEsR0FDRSxPQUFPUixRQUFRUyxJQUFJLENBQUNsSSxLQUFLbUksVUFBV25JLEtBQUtnSSxtQkFDM0MsQ0FFQUcsT0FBQUEsR0FDRSxPQUFPbkksS0FBSzRILFNBQVUsR0FBRTVILEtBQUtpSCxvQkFBcUIsQ0FDaERELFFBQVNoSCxLQUFLK0csVUFFbEIsQ0FFQXFCLHFCQUFBQSxDQUFzQkMsR0FDcEIsT0FBT3JJLEtBQUs0SCxTQUFVLEdBQUU1SCxLQUFLaUgsb0JBQXFCLENBQ2hEcUIsT0FBUSxRQUNSdEIsUUFBU2hILEtBQUsrRyxTQUNkd0IsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQnZJLEtBQU1tSSxFQUFnQm5JLEtBQ3RCd0ksTUFBT0wsRUFBZ0JLLFNBRzdCLENBRUFDLE9BQUFBLENBQVFDLEdBQ04sT0FBTzVJLEtBQUs0SCxTQUFVLEdBQUU1SCxLQUFLaUgsaUJBQWtCLENBQzdDcUIsT0FBUSxPQUNSdEIsUUFBU2hILEtBQUsrRyxTQUNkd0IsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQnZJLEtBQU0wSSxFQUFRMUksS0FDZEUsS0FBTXdJLEVBQVF4SSxRQUdwQixDQUVBNEIsVUFBQUEsQ0FBVzZHLEdBQ1QsT0FBTzdJLEtBQUs0SCxTQUFVLEdBQUU1SCxLQUFLaUgsa0JBQWtCNEIsSUFBVSxDQUN2RFAsT0FBUSxTQUNSdEIsUUFBU2hILEtBQUsrRyxTQUNkK0IsUUFBUyw4QkFFYixDQUVBQyxRQUFBQSxDQUFTRixHQUNQLE9BQU83SSxLQUFLNEgsU0FBVSxHQUFFNUgsS0FBS2lILGtCQUFrQjRCLFVBQWdCLENBQzdEUCxPQUFRLE1BQ1J0QixRQUFTaEgsS0FBSytHLFVBRWxCLENBRUFpQyxXQUFBQSxDQUFZSCxHQUNWLE9BQU83SSxLQUFLNEgsU0FBVSxHQUFFNUgsS0FBS2lILGtCQUFrQjRCLFVBQWdCLENBQzdEUCxPQUFRLFNBQ1J0QixRQUFTaEgsS0FBSytHLFVBRWxCLENBRUFrQyxZQUFBQSxDQUFhdEosR0FDWCxPQUFPSyxLQUFLNEgsU0FBVSxHQUFFNUgsS0FBS2lILDJCQUE0QixDQUN2RHFCLE9BQVEsUUFDUnRCLFFBQVNoSCxLQUFLK0csU0FDZHdCLEtBQU1DLEtBQUtDLFVBQVUsQ0FDbkJTLE9BQVF2SixLQUdkLEdEbEVrQixDQUNsQnVILFFBQVMsa0RBQ1RGLFFBQVMsQ0FDUEksY0FBZSx1Q0FDZixlQUFnQixzQkFJZCtCLEVBQWMsSUUxQmIsTUFDTHpKLFdBQUFBLENBQVcwSixFQUFlQyxHQUFlLElBQTdCLFNBQUVDLEdBQVVGLEVBRXRCcEosS0FBS3VKLFVBQVlELEVBQ2pCdEosS0FBS3dKLFdBQWFySyxTQUFTQyxjQUFjaUssRUFDM0MsQ0FFQUksT0FBQUEsQ0FBUUMsR0FDTjFKLEtBQUt1SixVQUFVRyxFQUNqQixDQUVBQyxXQUFBQSxDQUFZQyxHQUNWQSxFQUFNckYsU0FBU21GLElBQ2IxSixLQUFLdUosVUFBVUcsRUFBTSxTQUFTLEdBRWxDLEdGWUEsQ0FDRUosU0FBVSxTQUFDSSxHQUE2QixJQUF2QnBCLEVBQU11QixVQUFBQyxPQUFBLFFBQUFDLElBQUFGLFVBQUEsR0FBQUEsVUFBQSxHQUFHLFVBQ3hCLE1BQU1HLEVBc0dHLElBQUl2SyxFQXRHa0JpSyxFQXdHakMsbUJBQ0E3SixFQUNBb0ssRUFDQWxLLEdBQ0EsR0FFVTZCLGVBN0dSckMsRUFBYytJLEdBQVEwQixFQUN4QixHQUVGLGtCQUlGbkQsRUFDR21CLGtCQUNBRCxNQUFNVCxJQUNMNkIsRUFBWVEsWUFBWXJDLEdBQ3hCQSxFQUFJL0MsU0FBUzJGLE9BQWMsSUFFNUJDLE9BQU9DLElBQ05DLFFBQVFDLE1BQU1GLEVBQUksSUFJdEIsTUFBTUcsRUFBZ0IsSUFBSTVFLEVBQ3hCLG1CQWtHRixTQUE4QlMsR0FDNUJtRSxFQUFjaEUsZUFBYyxHQUM1Qk0sRUFDRzhCLFFBQVF2QyxHQUNSMkIsTUFBTXlDLElBV1gsSUFBb0JkLElBVkhjLEVBV2ZyQixFQUFZTSxRQUFRQyxHQVZoQmEsRUFBY2xGLFFBQ2RrRixFQUFjNUQsT0FBTyxJQUV0QndELE1BQU1FLFFBQVFDLE9BQ2RHLFNBQVEsS0FDUEYsRUFBY2hFLGVBQWMsRUFBTSxHQUV4QyxJQTVHQWdFLEVBQWM3RSxvQkFFZCxNQUFNZ0YsRUFBbUIsSUFBSS9FLEVBQzNCLHVCQTRERixTQUFpQ1MsR0FDL0JzRSxFQUFpQm5FLGVBQWMsR0FDL0JNLEVBQ0d1QixzQkFBc0JoQyxHQUN0QjJCLE1BQU1NLElBQ0xzQyxFQUF1QkMsWUFBWXZDLEdBQ25DcUMsRUFBaUJyRixRQUNqQnFGLEVBQWlCL0QsT0FBTyxJQUV6QndELE1BQU1FLFFBQVFDLE9BQ2RHLFNBQVEsS0FDUEMsRUFBaUJuRSxlQUFjLEVBQU0sR0FFM0MsSUF0RUFtRSxFQUFpQmhGLG9CQUVqQixNQUFNbUYsRUFBaUIsSUcxRGhCLGNBQTZCL0YsRUFDbENwRixXQUFBQSxDQUFZcUYsR0FDVmMsTUFBTWQsR0FDTi9FLEtBQUs4SyxZQUFjOUssS0FBS2dGLGNBQWM1RixjQUFjLHdCQUNwRFksS0FBSytLLFdBQWEvSyxLQUFLZ0YsY0FBYzVGLGNBQWMsc0JBQ3JELENBRUE4RixJQUFBQSxDQUFJa0UsR0FBaUIsSUFBaEIsS0FBRWxKLEVBQUksS0FBRUUsR0FBTWdKLEVBQ2pCcEosS0FBSzhLLFlBQVl0SixZQUFjdEIsRUFDL0JGLEtBQUsrSyxXQUFXdEosSUFBTXJCLEVBQ3RCSixLQUFLK0ssV0FBV3JKLElBQU14QixFQUV0QjJGLE1BQU1YLE1BQ1IsR0g2Q3dDLHlCQUMxQzJGLEVBQWVuRixvQkFFZixNQUFNaUYsRUFBeUIsSUkvRHhCLE1BQ0xqTCxXQUFBQSxDQUNFc0wsRUFDQUMsRUFDQUMsR0FFQWxMLEtBQUttTCxhQUFlaE0sU0FBU0MsY0FBYzRMLEdBQzNDaEwsS0FBS29MLG9CQUFzQmpNLFNBQVNDLGNBQ2xDNkwsR0FFRmpMLEtBQUtxTCxlQUFpQmxNLFNBQVNDLGNBQWM4TCxFQUMvQyxDQUVBSSxXQUFBQSxHQUNFLE1BQU8sQ0FDTHBMLEtBQU1GLEtBQUttTCxhQUFhM0osWUFDeEJrSCxNQUFPMUksS0FBS29MLG9CQUFvQjVKLFlBQ2hDMEgsT0FBUWxKLEtBQUtxTCxlQUFlNUosSUFFaEMsQ0FFQW1KLFdBQUFBLENBQVd4QixHQUlSLElBSERsSixLQUFNcUwsRUFDTjdDLE1BQU84QyxFQUNQdEMsT0FBUXVDLEdBQ1RyQyxFQUNDcEosS0FBS21MLGFBQWEzSixZQUFjK0osRUFDaEN2TCxLQUFLb0wsb0JBQW9CNUosWUFBY2dLLEVBQ3ZDeEwsS0FBSzBMLGNBQWNELEVBQ3JCLENBRUFDLGFBQUFBLENBQWNELEdBQ1p6TCxLQUFLcUwsZUFBZTVKLElBQU1nSyxDQUM1QixHSitCQSxpQkFDQSx3QkFDQSw0QkFHSUUsRUFBa0IsSUFBSWhHLEVBQWMsc0JBQzFDZ0csRUFBZ0JqRyxvQkFFaEIsTUFBTWtHLEVBQW9CLElBQUlqRyxFQUM1Qix3QkFzSUYsU0FBMkJrRyxHQUF1QixJQUFwQjNMLEtBQU00TCxHQUFZRCxFQUM5Q0QsRUFBa0JyRixlQUFjLEdBQ2hDTSxFQUNHb0MsYUFBYTZDLEdBQ2IvRCxNQUFLLEtBQ0o0QyxFQUF1QmUsY0FBY0ksR0FDckNGLEVBQWtCdkcsUUFDbEJ1RyxFQUFrQmpGLE9BQU8sSUFFMUJ3RCxNQUFNRSxRQUFRQyxPQUNkRyxTQUFRLEtBQ1BtQixFQUFrQnJGLGVBQWMsRUFBTSxHQUU1QyxJQWhKQXFGLEVBQWtCbEcsb0JBR2xCLE1BQU1xRyxFQUFpQixDQUFDLEVBRUVDLE1BNkQxQixTQUFTbk0sRUFBZ0J1SixHQUFpQixJQUFoQixLQUFFbEosRUFBSSxLQUFFRSxHQUFNZ0osRUFDdEN5QixFQUFlM0YsS0FBSyxDQUFFaEYsT0FBTUUsUUFDOUIsQ0F1QkEsU0FBUzZKLEVBQWlCZ0MsR0FDeEIsTUFBTXBELEVBQVNvRCxFQUFLbkssWUFDcEI2SixFQUFnQnpHLE9BQ2hCeUcsRUFBZ0JsRixXQUFVLEtBQ3hCa0YsRUFBZ0JwRixlQUFjLEdBQzlCTSxFQUNHN0UsV0FBVzZHLEdBQ1hkLE1BQUssS0FDSmtFLEVBQUtqSyxhQUNMMkosRUFBZ0J0RyxPQUFPLElBRXhCOEUsTUFBTUUsUUFBUUMsT0FDZEcsU0FBUSxLQUNQa0IsRUFBZ0JwRixlQUFjLEVBQU0sR0FDcEMsR0FFUixDQUdBLFNBQVN4RyxFQUFla00sR0FDdEIsTUFBTXBELEVBQVNvRCxFQUFLbkssWUFFSCxHQURDbUssRUFBS2xLLGlCQUVyQjhFLEVBQ0drQyxTQUFTRixHQUNUZCxNQUFLLEtBQ0prRSxFQUFLNUosZ0JBQWdCLElBRXRCOEgsTUFBTUUsUUFBUUMsT0FFakJ6RCxFQUNHbUMsWUFBWUgsR0FDWmQsTUFBSyxLQUNKa0UsRUFBSzVKLGdCQUFnQixJQUV0QjhILE1BQU1FLFFBQVFDLE1BRXJCLENBM0gwQjBCLEVML0JELENBQ3ZCRSxhQUFjLG9CQUNkdkosY0FBZSxnQkFDZkUscUJBQXNCLHdCQUN0QkUsb0JBQXFCLGdDQUNyQkUsZ0JBQWlCLDBCQUNqQkUsV0FBWSw0QkFDWkUsaUJBQWtCLG9CS3lCRG1CLE1BQU1DLEtBQUt0RixTQUFTdUYsaUJBQWlCc0gsRUFBT0UsZUFDcEQzSCxTQUFTOUIsSUFDaEIsTUFBTTBKLEVBQVksSUFBSTVKLEVBQWN5SixFQUFRdkosR0FDdEMySixFQUFXM0osRUFBWTRKLGFBQWEsTUFFMUNOLEVBQWVLLEdBQVlELEVBQzNCQSxFQUFVeEgsa0JBQWtCLElBUWhDekYsRUFBa0JvRCxpQkFBaUIsU0FBUyxLQUMxQ29JLEVBQWlCOUQsZUFBZStELEVBQXVCVyxlQUN2RFosRUFBaUJ4RixPQUNqQjZHLEVBQWUsZ0JBQWdCekgsaUJBQWlCLElBSWxEakYsRUFBY2lELGlCQUFpQixTQUFTLEtBQ3RDaUksRUFBY3JGLE9BQ2Q2RyxFQUFlLGlCQUFpQnpILGlCQUFpQixJQUluRDlFLEVBQWE4QyxpQkFBaUIsU0FBUyxLQUNyQ3NKLEVBQWtCMUcsT0FDbEI2RyxFQUFlLHNCQUFzQnpILGlCQUFpQixJQWdIeER1QyxFQUNHc0IsVUFDQUosTUFBTVQsSUFDTHFELEVBQXVCQyxZQUFZdEQsRUFBSSxJQUV4QzZDLE1BQU1FLFFBQVFDLE0iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJHb2F0IGluIGEgZmllbGRcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE1MDYwNzYxNzc4OTMtODlkNTQ3OTRlZjQxP3E9ODAmdz0xOTc0JmF1dG89Zm9ybWF0JmZpdD1jcm9wJml4bGliPXJiLTQuMC4zJml4aWQ9TTN3eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDhmQSUzRCUzRFwiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJTbm93eSBsYW5kc2NhcGVcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE3MDk0MDMzMzY2MDEtYzY5NGIwMmQwNGVjP3E9ODAmdz0xOTc0JmF1dG89Zm9ybWF0JmZpdD1jcm9wJml4bGliPXJiLTQuMC4zJml4aWQ9TTN3eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDhmQSUzRCUzRFwiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJDb2FzdGxpbmUgXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNzA3MzQzODQzOTgyLWY4Mjc1ZjM5OTRjNT9xPTgwJnc9MTkzMiZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZpeGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRGOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0RcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiR2FsYXh5IG9mIHN0YXJzXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNzA5NDAzMzM4NTI3LTgyMjk5MTJiM2E2Nz9xPTgwJnc9MTkzMiZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZpeGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0RcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTW91bnQgRXZlcmVzdFwiLFxyXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTU3NTgxOTcxOTc5OC04M2Q5N2RkNjk0OWM/cT04MCZ3PTIwNjkmYXV0bz1mb3JtYXQmZml0PWNyb3AmaXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlNjaG9vbCBvZiBmaXNoXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNzA3MzI3OTU2ODUxLTMwYTUzMWI3MGNkYT9xPTgwJnc9MjA3MCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZpeGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRGOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0RcIixcclxuICB9LFxyXG5dO1xyXG5cclxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5cclxuLyogRWxlbWVudHMgKi9cclxuLy8gRWxlbWVudHMgdXNlZCB0byBvcGVuIGFuZCBjbG9zZSB0aGUgRWRpdCBQcm9maWxlIE1vZGFsIGFuZCBDYXJkIEFkZCBNb2RhbFxyXG5cclxuY29uc3QgYWRkQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuXHJcbmNvbnN0IGNhcmRJbWFnZURpc3BsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Bob3Rvcy1kaXNwbGF5LW1vZGFsXCIpO1xyXG5cclxuLy9FbGVtZW50cyB1c2VkIGZvciBwaG90b3MgdGVtcGxhdGVzXHJcbmNvbnN0IHBob3RvQ2FyZExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBob3Rvc19fbGlzdFwiKTtcclxuXHJcblxyXG5jb25zdCBjYXJkSW1hZ2VEaXNwbGF5TGluayA9IGNhcmRJbWFnZURpc3BsYXkucXVlcnlTZWxlY3RvcihcclxuICBcIi5tb2RhbF9fcGhvdG9zLWxpbmtcIlxyXG4pO1xyXG5cclxuY29uc3QgY2FyZEltYWdlRGlzcGxheU5hbWUgPSBjYXJkSW1hZ2VEaXNwbGF5LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWxfX3Bob3Rvcy10aXRsZVwiXHJcbik7XHJcblxyXG5jb25zdCBhdmF0YXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1idG5cIik7XHJcblxyXG5jb25zdCB2YWxpZGF0aW9uQ29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2NvbnRhaW5lclwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3N1Ym1pdC1idXR0b25faW5hY3RpdmVcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dC1lcnJvcl9hY3RpdmVcIixcclxuICBmaWVsZHNldFNlbGVjdG9yOiBcIi5tb2RhbF9fZmllbGRzZXRcIixcclxufTtcclxuXHJcbmV4cG9ydCB7XHJcbiAgaW5pdGlhbENhcmRzLFxyXG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxyXG4gIGFkZENhcmRCdXR0b24sXHJcbiAgcGhvdG9DYXJkTGlzdCxcclxuICBjYXJkSW1hZ2VEaXNwbGF5TGluayxcclxuICBjYXJkSW1hZ2VEaXNwbGF5TmFtZSxcclxuICB2YWxpZGF0aW9uQ29uZmlnLFxyXG4gIGF2YXRhckJ1dHRvblxyXG59O1xyXG4iLCJjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGRhdGEsXHJcbiAgICBjYXJkU2VsZWN0b3IsXHJcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxyXG4gICAgaGFuZGxlRGVsZXRlQ2FyZCxcclxuICAgIGhhbmRsZUxpa2VDYXJkXHJcbiAgKSB7XHJcbiAgICB0aGlzLl9jYXJkTmFtZSA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZSA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2NhcmRBbHQgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQgPSBoYW5kbGVEZWxldGVDYXJkO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZUNhcmQgPSBoYW5kbGVMaWtlQ2FyZDtcclxuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XHJcbiAgICB0aGlzLl9pc0xpa2VkID0gZGF0YS5pc0xpa2VkO1xyXG4gIH1cclxuXHJcbiAgX2dldFZpZXcoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5waG90b3NfX2NhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBob3Rvc19fbGlrZS1idXR0b25cIik7XHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5waG90b3NfX2RlbGV0ZS1idXR0b25cIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGhvdG9zX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50TmFtZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGhvdG9zX19jYXB0aW9uXCIpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGhvdG9zX19pbWFnZVwiKTtcclxuXHJcbiAgICBpZiAodGhpcy5faXNMaWtlZCA9PT0gdHJ1ZSkge1xyXG4gICAgICB0aGlzLl9saWtlQ2FyZCgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldENhcmREYXRhKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnROYW1lLnRleHRDb250ZW50ID0gdGhpcy5fY2FyZE5hbWU7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudEltYWdlLnNyYyA9IHRoaXMuX2NhcmRJbWFnZTtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50SW1hZ2UuYWx0ID0gdGhpcy5fY2FyZE5hbWU7XHJcbiAgfVxyXG5cclxuICBnZXRDYXJkRWxlbWVudCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2dldFZpZXcoKTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9zZXRDYXJkRGF0YSgpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIGdldENhcmRJZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pZDtcclxuICB9XHJcblxyXG4gIGdldENhcmRJc0xpa2VkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lzTGlrZWQ7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG5cclxuICBfbGlrZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJwaG90b3NfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIHRoaXMuX2lzTGlrZWQgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgX2Rpc2xpa2VDYXJkKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwicGhvdG9zX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB0aGlzLl9pc0xpa2VkID0gZmFsc2U7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVDYXJkTGlrZSgpIHtcclxuICAgIGlmICh0aGlzLl9pc0xpa2VkID09PSBmYWxzZSkge1xyXG4gICAgICB0aGlzLl9saWtlQ2FyZCgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fZGlzbGlrZUNhcmQoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKHRoaXMpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fY2FyZEltYWdlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soeyBuYW1lOiB0aGlzLl9jYXJkTmFtZSwgbGluazogdGhpcy5fY2FyZEltYWdlIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2FyZCh0aGlzKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IHsgQ2FyZCB9O1xyXG4iLCJleHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3IodmFsaWRhdGlvbkNvbmZpZywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSB2YWxpZGF0aW9uQ29uZmlnLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHZhbGlkYXRpb25Db25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gdmFsaWRhdGlvbkNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gdmFsaWRhdGlvbkNvbmZpZy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gdmFsaWRhdGlvbkNvbmZpZy5lcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZmllbGRzZXRTZWxlY3RvciA9IHZhbGlkYXRpb25Db25maWcuZmllbGRzZXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuICAgICk7XHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGZ1bmN0aW9uIChldnQpIHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLm1vZGFsX19jbG9zZS1idXR0b25cIlxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5fY2xvc2VPbk92ZXJsYXlDbGljayk7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9jbG9zZU9uRXNjS2V5KTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2Nsb3NlT25PdmVybGF5Q2xpY2spO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5fY2xvc2VPbkVzY0tleSk7XHJcbiAgfVxyXG5cclxuICBfY2xvc2VPbk92ZXJsYXlDbGljayA9IChldnQpID0+IHtcclxuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSkge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX2Nsb3NlT25Fc2NLZXkgPSAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuXHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jb250YWluZXJcIik7XHJcbiAgICB0aGlzLl9wb3B1cEFycmF5ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLl9wb3B1cEFycmF5KTtcclxuICAgIHRoaXMuX29yaWdpbmFsU3VibWl0VGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlKCkge1xyXG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XHJcbiAgfVxyXG5cclxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZykge1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fb3JpZ2luYWxTdWJtaXRUZXh0O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0U3VibWl0KGhhbmRsZVN1Ym1pdCkge1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZVN1Ym1pdDtcclxuICB9XHJcblxyXG4gIHJlc2V0KCkge1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcbiAgfVxyXG5cclxuICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlKCkpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHtcclxuICBpbml0aWFsQ2FyZHMsXHJcbiAgcHJvZmlsZUVkaXRCdXR0b24sXHJcbiAgYWRkQ2FyZEJ1dHRvbixcclxuICBwaG90b0NhcmRMaXN0LFxyXG4gIHZhbGlkYXRpb25Db25maWcsXHJcbiAgYXZhdGFyQnV0dG9uLFxyXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IHsgQ2FyZCB9IGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHsgU2VjdGlvbiB9IGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cC5qc1wiO1xyXG5pbXBvcnQgeyBQb3B1cFdpdGhJbWFnZSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCB7IFBvcHVwV2l0aEZvcm0gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCB7IFVzZXJJbmZvIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IHsgQXBpIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJiODhiNzcwZi05NjY1LTQ4NjItYmM3YS0xYTVhYThjNDE0N2FcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICB7XHJcbiAgICByZW5kZXJlcjogKGl0ZW0sIG1ldGhvZCA9IFwicHJlcGVuZFwiKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChpdGVtKTtcclxuICAgICAgcGhvdG9DYXJkTGlzdFttZXRob2RdKGNhcmRFbGVtZW50KTtcclxuICAgIH0sXHJcbiAgfSxcclxuICBcIiNjYXJkLWFkZC1mb3JtXCJcclxuKTtcclxuXHJcbi8vR2V0dGluZyB0aGUgbGlzdCBvZiBjYXJkcyBmcm9tIHRoZSBzZXJ2ZXIgYW5kIGRpc3BsYXlpbmcgaXQgb24gdGhlIGZvcm1cclxuYXBpXHJcbiAgLmdldEluaXRpYWxDYXJkcygpXHJcbiAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMocmVzKTtcclxuICAgIHJlcy5mb3JFYWNoKChyZXN1bHQpID0+IHt9KTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgfSk7XHJcblxyXG4vLyBDbGFzcyBhc3NpZ25tZW50IGZvciBhbGwgcG9wdXBzXHJcbmNvbnN0IGNhcmRGb3JtUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNjYXJkLWFkZC1tb2RhbFwiLFxyXG4gIGhhbmRsZUNhcmRGb3JtU3VibWl0XHJcbik7XHJcbmNhcmRGb3JtUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVGb3JtUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcclxuICBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdFxyXG4pO1xyXG5wcm9maWxlRm9ybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBwaG90b0NhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNwaG90b3MtZGlzcGxheS1tb2RhbFwiKTtcclxucGhvdG9DYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IHVzZXJQcm9maWxlSW5mb3JtYXRpb24gPSBuZXcgVXNlckluZm8oXHJcbiAgXCIucHJvZmlsZV9fbmFtZVwiLFxyXG4gIFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXHJcbiAgXCIucHJvZmlsZV9fYXZhdGFyLXBpY3R1cmVcIlxyXG4pO1xyXG5cclxuY29uc3QgZGVsZXRlQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjZGVsZXRlLWNhcmQtbW9kYWxcIik7XHJcbmRlbGV0ZUNhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgYXZhdGFyVXBkYXRlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNhdmF0YXItdXBkYXRlLW1vZGFsXCIsXHJcbiAgaGFuZGxlQXZhdGFyVXBkYXRlXHJcbik7XHJcbmF2YXRhclVwZGF0ZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL0Zvcm0gdmFsaWRhdG9yc1xyXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xyXG5cclxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKSk7XHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcclxuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpO1xyXG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJpZFwiKTtcclxuXHJcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XHJcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uQ29uZmlnKTtcclxuXHJcbi8qIEV2ZW50IExpc3RlbmVycyAqL1xyXG4vL0V2ZW50IExpc3RlbmVycyBmb3Igb3BlbmluZyBhbmQgY2xvc2luZyB0aGUgZWRpdCBwcm9maWxlIG1vZGFsXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgcHJvZmlsZUZvcm1Qb3B1cC5zZXRJbnB1dFZhbHVlcyh1c2VyUHJvZmlsZUluZm9ybWF0aW9uLmdldFVzZXJJbmZvKCkpO1xyXG4gIHByb2ZpbGVGb3JtUG9wdXAub3BlbigpO1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wicHJvZmlsZS1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcbi8vRXZlbnQgTGlzdGVuZXJzIGZvciBvcGVuaW5nIGFuZCBjbG9zaW5nIHRoZSBhZGQgY2FyZCBtb2RhbFxyXG5hZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY2FyZEZvcm1Qb3B1cC5vcGVuKCk7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJjYXJkLWFkZC1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcbi8vRXZlbnQgTGlzdGVuZXJzIGZvciB0aGUgQXZhdGFyIFVwZGF0ZSBtb2RhbFxyXG5hdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhdmF0YXJVcGRhdGVQb3B1cC5vcGVuKCk7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJhdmF0YXItdXBkYXRlLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG5cclxuLy9VcGRhdGluZyBwcm9maWxlIGluZm9ybWF0aW9uXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KGlucHV0VmFsdWVzKSB7XHJcbiAgcHJvZmlsZUZvcm1Qb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLnVwZGF0ZVVzZXJJbmZvcm1hdGlvbihpbnB1dFZhbHVlcylcclxuICAgIC50aGVuKCh1c2VySW5mb3JtYXRpb24pID0+IHtcclxuICAgICAgdXNlclByb2ZpbGVJbmZvcm1hdGlvbi5zZXRVc2VySW5mbyh1c2VySW5mb3JtYXRpb24pO1xyXG4gICAgICBwcm9maWxlRm9ybVBvcHVwLmNsb3NlKCk7XHJcbiAgICAgIHByb2ZpbGVGb3JtUG9wdXAucmVzZXQoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcHJvZmlsZUZvcm1Qb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGVsZW1lbnQpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICBlbGVtZW50LFxyXG4gICAgXCIjcGhvdG9zLXRlbXBsYXRlXCIsXHJcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxyXG4gICAgaGFuZGxlQ2FyZERlbGV0ZSxcclxuICAgIGhhbmRsZUxpa2VDYXJkLFxyXG4gICAgZmFsc2VcclxuICApO1xyXG4gIHJldHVybiBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgcGhvdG9DYXJkUG9wdXAub3Blbih7IG5hbWUsIGxpbmsgfSk7XHJcbn1cclxuXHJcbi8vIFN1Ym1pdHRpbmcgYSBuZXcgY2FyZCB0byB0aGUgc2VydmVyXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRGb3JtU3VibWl0KGlucHV0VmFsdWVzKSB7XHJcbiAgY2FyZEZvcm1Qb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmFkZENhcmQoaW5wdXRWYWx1ZXMpXHJcbiAgICAudGhlbigobmV3Q2FyZCkgPT4ge1xyXG4gICAgICByZW5kZXJDYXJkKG5ld0NhcmQpO1xyXG4gICAgICBjYXJkRm9ybVBvcHVwLmNsb3NlKCk7XHJcbiAgICAgIGNhcmRGb3JtUG9wdXAucmVzZXQoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgY2FyZEZvcm1Qb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW5kZXJDYXJkKGl0ZW0sIG1ldGhvZCA9IFwicHJlcGVuZFwiKSB7XHJcbiAgY2FyZFNlY3Rpb24uYWRkSXRlbShpdGVtKTtcclxufVxyXG5cclxuLy9EZWxldGUgY2FyZFxyXG5mdW5jdGlvbiBoYW5kbGVDYXJkRGVsZXRlKGNhcmQpIHtcclxuICBjb25zdCBjYXJkSWQgPSBjYXJkLmdldENhcmRJZCgpO1xyXG4gIGRlbGV0ZUNhcmRQb3B1cC5vcGVuKCk7XHJcbiAgZGVsZXRlQ2FyZFBvcHVwLnNldFN1Ym1pdCgoKSA9PiB7XHJcbiAgICBkZWxldGVDYXJkUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuICAgIGFwaVxyXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkSWQpXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBjYXJkLmRlbGV0ZUNhcmQoKTtcclxuICAgICAgICBkZWxldGVDYXJkUG9wdXAuY2xvc2UoKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICBkZWxldGVDYXJkUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICAgIH0pO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vL2hhbmRsZXMgYm90aCBsaWtlIGFuZCBkaXNsaWtlIG9mIGNhcmRzXHJcbmZ1bmN0aW9uIGhhbmRsZUxpa2VDYXJkKGNhcmQpIHtcclxuICBjb25zdCBjYXJkSWQgPSBjYXJkLmdldENhcmRJZCgpO1xyXG4gIGNvbnN0IGNhcmRMaWtlZCA9IGNhcmQuZ2V0Q2FyZElzTGlrZWQoKTtcclxuICBpZiAoY2FyZExpa2VkID09IGZhbHNlKSB7XHJcbiAgICBhcGlcclxuICAgICAgLmxpa2VDYXJkKGNhcmRJZClcclxuICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGNhcmQudXBkYXRlQ2FyZExpa2UoKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBhcGlcclxuICAgICAgLmRpc2xpa2VDYXJkKGNhcmRJZClcclxuICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGNhcmQudXBkYXRlQ2FyZExpa2UoKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG4gIH1cclxufVxyXG5cclxuLy91cGRhdGluZyB0aGUgYXZhdGFyXHJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclVwZGF0ZSh7IG5hbWU6IGlucHV0VmFsdWUgfSkge1xyXG4gIGF2YXRhclVwZGF0ZVBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAudWRwYXRlQXZhdGFyKGlucHV0VmFsdWUpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIHVzZXJQcm9maWxlSW5mb3JtYXRpb24uc2V0VXNlckF2YXRhcihpbnB1dFZhbHVlKTtcclxuICAgICAgYXZhdGFyVXBkYXRlUG9wdXAuY2xvc2UoKTtcclxuICAgICAgYXZhdGFyVXBkYXRlUG9wdXAucmVzZXQoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgYXZhdGFyVXBkYXRlUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLy8gR2V0IHVzZXIgZGF0YSBmcm9tIHRoZSBzZXJ2ZXJcclxuYXBpXHJcbiAgLmdldFVzZXIoKVxyXG4gIC50aGVuKChyZXMpID0+IHtcclxuICAgIHVzZXJQcm9maWxlSW5mb3JtYXRpb24uc2V0VXNlckluZm8ocmVzKTtcclxuICB9KVxyXG4gIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxuIiwiY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IG9wdGlvbnMuYmFzZVVybDtcclxuICAgIHRoaXMuX2F1dGhUb2tlbiA9IG9wdGlvbnMuaGVhZGVycy5hdXRob3JpemF0aW9uO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuXHJcbiAgX3JlcXVlc3QodXJsLCBvcHRpb25zKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godXJsLCBvcHRpb25zKS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7IGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mb3JtYXRpb24oKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0VXNlcigpLCB0aGlzLmdldEluaXRpYWxDYXJkcygpXSk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VyKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZVVzZXJJbmZvcm1hdGlvbih1c2VySW5mb3JtYXRpb24pIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IHVzZXJJbmZvcm1hdGlvbi5uYW1lLFxyXG4gICAgICAgIGFib3V0OiB1c2VySW5mb3JtYXRpb24uYWJvdXQsXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRDYXJkKGVsZW1lbnQpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogZWxlbWVudC5uYW1lLFxyXG4gICAgICAgIGxpbms6IGVsZW1lbnQubGluayxcclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWVzc2FnZTogXCJUaGlzIHBvc3QgaGFzIGJlZW4gZGVsZXRlZFwiLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkaXNsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB1ZHBhdGVBdmF0YXIoZGF0YSkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogZGF0YSxcclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCB7IEFwaSB9O1xyXG4iLCJleHBvcnQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyByZW5kZXJlciB9LCBjbGFzc1NlbGVjdG9yKSB7XHJcbiAgICAvLyB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY2xhc3NTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGl0ZW0pIHtcclxuICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoaXRlbXMpIHtcclxuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSwgXCJhcHBlbmRcIik7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faW1hZ2VUaXRsZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19waG90b3MtdGl0bGVcIik7XHJcbiAgICB0aGlzLl9pbWFnZUxpbmsgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcGhvdG9zLWxpbmtcIik7XHJcbiAgfVxyXG5cclxuICBvcGVuKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICB0aGlzLl9pbWFnZVRpdGxlLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2ltYWdlTGluay5zcmMgPSBsaW5rO1xyXG4gICAgdGhpcy5faW1hZ2VMaW5rLmFsdCA9IG5hbWU7XHJcblxyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJvZmlsZU5hbWVTZWxlY3RvcixcclxuICAgIHByb2ZpbGVEZXNjcmlwdGlvblNlbGVjdG9yLFxyXG4gICAgcHJvZmlsZUF2YXRhclNlbGVjdG9yXHJcbiAgKSB7XHJcbiAgICB0aGlzLl9wcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZU5hbWVTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBwcm9maWxlRGVzY3JpcHRpb25TZWxlY3RvclxyXG4gICAgKTtcclxuICAgIHRoaXMuX3Byb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVBdmF0YXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50LFxyXG4gICAgICBhYm91dDogdGhpcy5fcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50LFxyXG4gICAgICBhdmF0YXI6IHRoaXMuX3Byb2ZpbGVBdmF0YXIuc3JjLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKHtcclxuICAgIG5hbWU6IHByb2ZpbGVOYW1lLFxyXG4gICAgYWJvdXQ6IHByb2ZpbGVEZXNjcmlwdGlvbixcclxuICAgIGF2YXRhcjogcHJvZmlsZUF2YXRhcixcclxuICB9KSB7XHJcbiAgICB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHByb2ZpbGVOYW1lO1xyXG4gICAgdGhpcy5fcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gcHJvZmlsZURlc2NyaXB0aW9uO1xyXG4gICAgdGhpcy5zZXRVc2VyQXZhdGFyKHByb2ZpbGVBdmF0YXIpO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckF2YXRhcihwcm9maWxlQXZhdGFyKSB7XHJcbiAgICB0aGlzLl9wcm9maWxlQXZhdGFyLnNyYyA9IHByb2ZpbGVBdmF0YXI7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJwcm9maWxlRWRpdEJ1dHRvbiIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZENhcmRCdXR0b24iLCJjYXJkSW1hZ2VEaXNwbGF5IiwicGhvdG9DYXJkTGlzdCIsImF2YXRhckJ1dHRvbiIsIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2FyZCIsImhhbmRsZUxpa2VDYXJkIiwidGhpcyIsIl9jYXJkTmFtZSIsIm5hbWUiLCJfY2FyZEltYWdlIiwibGluayIsIl9jYXJkQWx0IiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNhcmQiLCJfaGFuZGxlTGlrZUNhcmQiLCJfaWQiLCJfaXNMaWtlZCIsImlzTGlrZWQiLCJfZ2V0VmlldyIsIl9jYXJkRWxlbWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfbGlrZUJ1dHRvbiIsIl9kZWxldGVCdXR0b24iLCJfY2FyZEltYWdlQnV0dG9uIiwiX2NhcmRFbGVtZW50TmFtZSIsIl9jYXJkRWxlbWVudEltYWdlIiwiX2xpa2VDYXJkIiwiX3NldENhcmREYXRhIiwidGV4dENvbnRlbnQiLCJzcmMiLCJhbHQiLCJnZXRDYXJkRWxlbWVudCIsImdlbmVyYXRlQ2FyZCIsIl9zZXRFdmVudExpc3RlbmVycyIsImdldENhcmRJZCIsImdldENhcmRJc0xpa2VkIiwiZGVsZXRlQ2FyZCIsInJlbW92ZSIsImNsYXNzTGlzdCIsImFkZCIsIl9kaXNsaWtlQ2FyZCIsInVwZGF0ZUNhcmRMaWtlIiwiYWRkRXZlbnRMaXN0ZW5lciIsIkZvcm1WYWxpZGF0b3IiLCJ2YWxpZGF0aW9uQ29uZmlnIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZmllbGRzZXRTZWxlY3RvciIsImZpZWxkc2V0U2VsZWN0b3IiLCJfZm9ybUVsZW1lbnQiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvckVsZW1lbnQiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9idXR0b25FbGVtZW50IiwiZGlzYWJsZWQiLCJfaW5wdXRMaXN0Iiwic29tZSIsInZhbGlkaXR5IiwidmFsaWQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwicmVzZXRWYWxpZGF0aW9uIiwiZm9yRWFjaCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2Nsb3NlQnV0dG9uIiwib3BlbiIsIl9jbG9zZU9uT3ZlcmxheUNsaWNrIiwiX2Nsb3NlT25Fc2NLZXkiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJ0YXJnZXQiLCJjb250YWlucyIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX3N1Ym1pdEJ1dHRvbiIsIl9wb3B1cEZvcm0iLCJfcG9wdXBBcnJheSIsIl9vcmlnaW5hbFN1Ym1pdFRleHQiLCJfZ2V0SW5wdXRWYWx1ZSIsImlucHV0VmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJzZXRTdWJtaXQiLCJoYW5kbGVTdWJtaXQiLCJyZXNldCIsInNldElucHV0VmFsdWVzIiwiYXBpIiwib3B0aW9ucyIsIl9oZWFkZXJzIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiYmFzZVVybCIsIl9hdXRoVG9rZW4iLCJhdXRob3JpemF0aW9uIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiX3JlcXVlc3QiLCJ1cmwiLCJmZXRjaCIsInRoZW4iLCJnZXRJbml0aWFsQ2FyZHMiLCJnZXRVc2VySW5mb3JtYXRpb24iLCJhbGwiLCJnZXRVc2VyIiwidXBkYXRlVXNlckluZm9ybWF0aW9uIiwidXNlckluZm9ybWF0aW9uIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImFkZENhcmQiLCJlbGVtZW50IiwiY2FyZElkIiwibWVzc2FnZSIsImxpa2VDYXJkIiwiZGlzbGlrZUNhcmQiLCJ1ZHBhdGVBdmF0YXIiLCJhdmF0YXIiLCJjYXJkU2VjdGlvbiIsIl9yZWYiLCJjbGFzc1NlbGVjdG9yIiwicmVuZGVyZXIiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiYWRkSXRlbSIsIml0ZW0iLCJyZW5kZXJJdGVtcyIsIml0ZW1zIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiY2FyZEVsZW1lbnQiLCJoYW5kbGVDYXJkRGVsZXRlIiwicmVzdWx0IiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJjYXJkRm9ybVBvcHVwIiwibmV3Q2FyZCIsImZpbmFsbHkiLCJwcm9maWxlRm9ybVBvcHVwIiwidXNlclByb2ZpbGVJbmZvcm1hdGlvbiIsInNldFVzZXJJbmZvIiwicGhvdG9DYXJkUG9wdXAiLCJfaW1hZ2VUaXRsZSIsIl9pbWFnZUxpbmsiLCJwcm9maWxlTmFtZVNlbGVjdG9yIiwicHJvZmlsZURlc2NyaXB0aW9uU2VsZWN0b3IiLCJwcm9maWxlQXZhdGFyU2VsZWN0b3IiLCJfcHJvZmlsZU5hbWUiLCJfcHJvZmlsZURlc2NyaXB0aW9uIiwiX3Byb2ZpbGVBdmF0YXIiLCJnZXRVc2VySW5mbyIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwicHJvZmlsZUF2YXRhciIsInNldFVzZXJBdmF0YXIiLCJkZWxldGVDYXJkUG9wdXAiLCJhdmF0YXJVcGRhdGVQb3B1cCIsIl9yZWYyIiwiaW5wdXRWYWx1ZSIsImZvcm1WYWxpZGF0b3JzIiwiY29uZmlnIiwiY2FyZCIsImZvcm1TZWxlY3RvciIsInZhbGlkYXRvciIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIl0sInNvdXJjZVJvb3QiOiIifQ==